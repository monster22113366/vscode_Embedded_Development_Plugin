# Embedded C Toolchain

VS Code 嵌入式 C 开发扩展，专为 ARM Cortex-M 微控制器（STM32 等）打造。

**一键安装工具链 → 一键扫描工程 → 一键编译烧录调试**

## ✨ 核心功能

### 🔧 自动化工具链管理
- **自动检测**：扫描并识别系统已安装的 ARM GCC、OpenOCD、J-Link
- **一键安装**：内置下载器，自动安装缺失的工具
- **智能配置**：检测到工具后自动配置路径，无需手动设置

### 🚀 一键开发流程
- **扫描工程**（F6）：自动识别芯片型号、调试器类型、生成配置文件，**更新cmakelists**
- **编译项目**（F7）：增量编译，实时显示进度
- **烧录固件**（F8）：一键烧录到芯片
- **启动调试**（F5）：断点、单步、变量监视、内存查看、反汇编

### 🎨 可视化界面
- **侧边栏面板**：工具链状态、项目配置、快捷操作一目了然
- **状态栏**：实时显示工具链和编译状态

## 📦 快速开始

### 1. 安装扩展

下载embedded-c-toolchain-1.0.0.vsix，从vscode导入。

### 2. 安装工具链

打开任意 C 项目后：
- 点击侧边栏 **"Embedded C Toolchain"** 图标
- 点击顶部 **扫描按钮**（同步图标）
- 如果缺少工具，点击 **"安装缺失工具"**
- 安装完工具链，一定要**重启**！重启vscode才能加载出环境变量

其中，**cmake、ninja、arm-none-eabi-gcc**是编译三件套，**openocd**是烧录工具，**clangd**是语法诊断与代码补全工具。都是开源的工具。

### 3. 生成并扫描工程(第一次打开工程，以及写了新的c/cpp文件，h文件时，都要扫描一遍)

- stm32cubemx生成cubeide工程(也可以生成cmake工程，不过要6.14.0及更旧的版本，太新的版本的cubemx生成的cmakelists有问题。)
- vscode打开工程的根目录
- 按 F6 或命令面板输入 "Scan Project"
- 选择芯片型号（如 STM32F103C8）
- 选择调试器（OpenOCD / J-Link / ST-Link）


完成后自动生成 **或** 更新CMakeLists.txt、生成launch.json、.clang-format、.clangd 等配置文件。

一定要扫描工程！扫描工程插件才能知道工程的信息，才能提供语法诊断，能正确调用编译烧录工具，能提供烧录脚本，

### 4. 编译 → 烧录 → 调试

```bash
F7  # 编译项目
F8  # 烧录固件（需连接调试器）
F5  # 启动调试
```

## ⌨️ 快捷键

| 快捷键 | 功能 | 说明 |
|--------|------|------|
| **F5** | 启动调试 | 需先编译和连接调试器 |
| **F6** | 扫描工程 | 自动配置芯片和调试器 |
| **F7** | 编译项目 | 增量编译，只编译修改的文件 |
| **F8** | 烧录固件 | 将编译后的 .bin 烧录到芯片 |

## 🐛 常见问题

### 工具链未检测到？
1. 点击侧边栏 **"扫描工具链"** 按钮重新检测
2. 或使用命令 **"Embedded C: Setup Toolchain"** 手动安装

### 编译失败？
1. 确认工具链已安装：侧边栏显示 "2/2 已安装"
2. 检查工程是否已扫描：是否有 CMakeLists.txt 或 Makefile

### 烧录失败？
1. 确认调试器已连接并供电
2. 检查驱动是否安装（ST-Link / J-Link）
3. 尝试降低调试速度：`F1 → Select Debugger → 重新选择`

### 调试无法启动？
1. 首次使用需安装 Cortex-Debug：`F1 → Install Cortex-Debug`
2. 确认已完成编译（.elf 文件存在）

## 🔗 支持的芯片和工具

**芯片系列**：STM32F1/F4/F7/H7/G0/L4、GD32、MM32 等 ARM Cortex-M 系列

**工具链**：
- ARM GCC（必需）
- OpenOCD / J-Link / ST-Link（用于烧录和调试）
- Make / CMake（构建工具）

**调试扩展**：
- [Cortex-Debug](https://marketplace.visualstudio.com/items?itemName=marus25.cortex-debug)（推荐，一键安装）

## 💡 使用提示

### 查看反汇编
调试时右键编辑器 → **"Open Disassembly View"**

### 查看内存
调试侧边栏 → **MEMORY** 面板 → 输入地址或变量名

### 查看寄存器
调试侧边栏 → **REGISTERS** 面板 → 查看 CPU/外设寄存器

### 从地址跳转到源码
调试控制台输入：
```gdb
-exec info line *0x08000100
-exec list *0x08000100
```

## 📄 许可证

MIT License

---

**开始你的嵌入式开发之旅！** 🚀
